# Extracted information
[Automatic Sleep Stage Classification Based on Subthalamic Local Field Potentials](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6544463/pdf/nihms-1023642.pdf)

## Abstract
- Sleep disorders: common complications of Parkinson's Disease (PD) and can be further affected by subthalamic Deep Brain Stimulation (DBS) treatment
- Study chronically monitors sleep-wake cycles and investigates the use of closed-loop DBS to achieve more precise neuromodulation
    - Local field potential (LFP) signals sensed by the DBS electrode are processed as primary feedback signals
- Automatic sleep-stage classification models used **machine learning (support vector machine and decision tree)**
    - "**Features extracted in alpha (8-13 Hz), beta (13-35 Hz), and gamma (35-50 Hz) bands were found to contribute the most to the classification."**

## Introduction
- "Sleep disorders are commonly observed in PD patients [2],[3]."
- "Although the general quality of sleep is reported to be improved, the specific role of subthalamic nucleus (STN) HF-DBS in sleep is being questioned [4], [5]. Rapid eye movement (REM) sleep behavior disorder, restless legs syndrome, and periodic limbs movements are often found unimproved or even deteriorated following STN-DBS [4], [6], [7]."
- In this study, "**LFP recordings were taken instead of traditional electroencephalography (EEG)** in sleep considering the following aspects:" 
    1. "**LFPs-based methods have a better integrated capacity for a fully implanted closed-loop DBS system**, as shown in Fig. 1. In a previous study, we developed an implantable deep brain stimulator with the ability to record LFPs using the DBS electrode [17]. Compared with the traditional EEG-based methods, **LFP-based methods are more practical in reducing the engineering price of an additional sensing device, data transmission, and data synchronization.**"
    2. "The **LFP-based methods have better practicality for the chronic daily sleep-monitoring for DBS patients.** The current advanced DBS system provides a unique opportunity to investigate LFP sleep patterns without influence of surgical interferences including edema, infection, and micro-lesion in the acute surgery period [18], [19]. Validating LFP as a solid biomarker of sleep stages is of great potential for expanding the healthcare for DBS patients. **Compared with non-invasive EEG, LFP-based methods will not need any additional sensors to achieve sleep monitoring.**"
    3. "**LFP recorded in the brain target might be a better decoder for the clinical state during sleep.** In previous studies, **LFP has been reported as an indicator for the motor symptoms of PD patients and DBS has been reported as a modulator of LFP activities in the target [11], [12]**. It has been recognized as the first choice for feedback signals in the current investigation of closed-loop DBS [10]. It is foreseeable that in future closed-loop DBS studies, LFPs would be of great use to decode the real-time clinical and stimulation effects during sleep."
- With regards to finding solid algorithms or sleep stage classification:
    - "Whereas most studies have focused on the LFP and motor function in the daytime, some have reported LFP patterns during sleep [13], [14]."
    - "Although **it has been suggested there is an opportunity for taking LFP spectrums as an indicator for sleep sleep-stage transitions [14]**, little is known about the design of features, methods and the robustness of the result."
    - "**Classification studies involving the support vector machines (SVM), decision trees (DT) and other machine learning methods pave the way for building a new solid and interpretable classifier based on LFPs from STN.**"

## Methods and materials
### B. Data preprocessing
- "**MATLAB (version 2016a)** were used for calculations. **Spectrogram was calculated using a Short-Time Fourier Transform (STFT)** with a Hamming window of 1s and an overlap of 50%. **Power spectrum density (PSD)** of each 1s epoch in the data set were generated by the Welch’s method with a Hamming window of 0.2 s and an overlap of 75%. The range of the frequency analysis was unified to 0–50 Hz (Filter stop band below 0.5 Hz was ignored)"

### D. Classification and prediction
#### 1. Overall process of classification and prediction
- "Features were extracted from the 1s data segments from each class. The 2 Hz bandwidth power of PSD and sleep stage labels constituted the samples. 90% in each class were randomly selected for training and the remaining 10% in each class were for testing. A running average rule was applied to generate the final decisions."
- "To evaluate the method in a simulated online scene, we separately analyzed the performance in a test set which is completely isolated with the training set in time. The so-called “prediction” in the results means the data segments in the training set and test set are selected in time order. For prediction, the first 90% strictly in time domain of the raw data in each class were chosen for training. Thus, in each class, the remaining 10% were for testing."
- "**We performed the overall process of classification and prediction on the binary combinations, including wakefulness against N1, wakefulness against N2, wakefulness against REM, N1 against N2, N1 against REM, N2 against REM, and wakefulness against sleep (N1, N2, and REM) and the multi-class together.**"
- "In each class, the training and testing sets were partially separated with a proportion of 9:1. Before both training and testing, samples from each class were randomly selected to build balanced training and testing sets. To verify the robustness, the whole procedure that started with feature extraction was repeated 50 times. Cross-validation method was used for the model optimization and training to unbiasedly estimate performance. Details of the process are described in the following sub sections."

#### 2. Machine learning methods
- "**We developed our models with two learning methods in this study, the support vector machine (SVM) and decision tree (DT). Both of these are widely used in the classification for a variety of physiological signals.**"
- "A **SVM model is a space construction for mapping the examples**, aiming at **separating the classes by a gap that is as wide as possible** [27]. By properly choosing the **kernel function**, SVM is efficient for achieving both linear and non-linear classification"
- "A **decision tree is a group of conditional statements** for **improving the purity of each leaf**. A DT model could provide a clear path for a classification [29]. We used a **standard classification and regression tree (CART) model** [31] to generate a binary tree for classification. All the predictors were continuous. **Gini’s diversity index was used to calculate the impurity of nodes** in the decision tree."

#### 3. Optimization and training
- "The hyper-parameters were **optimized via grid search method**. For the SVM model, cost C represents the weight of how many samples inside the margin contribute to the overall error. C was optimized in the range of 2^2_10^. For the RBF kernel function of SVM model, γ was optimized in the range of and 2−15–2. For the DT model, the minimum leaf number was optimized in the range of 1–100. Five-fold for SVM and ten-fold for DT cross-validations were performed. Models were trained with the hyperparameters that achieved the highest classification accuracy in the training set."

#### 5. Performance measure
- "**For binary classification and prediction, the performance was measured by the overall accuracy, sensitivity, selectivity, and specificity.**"
    - "The overall accuracy was calculated by equation: ***Accuracy* = (TN~1~ + TN~2~)/(N~1~ + N~2~) * 100%** where N1 and N2 represent the numbers of samples in class 1 and class 2 from the test set. TN~1~ and TN~2~ represent the numbers of correct predictions of class 1 and class 2."
    - "The sensitivity was calculated by the equation: ***Sensitivity* = TN~1~/N~1~ * 100%**."
    - "The specificity was calculated by the equation: ***Specificity* = TN~2~/N~2~ * 100%**."
        - "The sensitivity and specificity, respectively, stand for the accuracy of class 1 and class 2."
    - "The selectivity was calculated by equation: ***Selectivity* = TN~1~/N'~1~ * 100%** where N'1 represents the number of class 1 in the predicted results. The selectivity stands for the ratio of actual class 1 instances in the predicted class 1 instances."
- "**For multi-class classification and prediction, the performance was measured by confusion matrixes [32]**."

## Results
- "The general rhythms of STN-LFP are clarified in Fig.5. However, from the shadow in Fig. 5(b) and error bars in Fig.5(c ), the standard deviations of PSDs and band power during wakefulness or each sleep stage were very large. From Fig.5(a), it was found that the LFP rhythms were fluctuating and not always consistent in every second. Besides, from individual PSDs, there is a big difference in the spectrum power across subjects. Therefore, the PSDs and band power in different sleep stages were overlapped. **This indicates that a simple threshold classification or an amplitude-responsive algorithm would not reach a satisfactory performance. Machine learning models are necessary to build a more general profile of the STN-LFP sleep patterns for the classification and prediction.** A running average method are worthy to confront the fluctuation of the signal without sacrificing the responding speed."

## Discussion
### B. STN-LFP activity patterns during sleep state
- "This study also reveals STN-LFP patterns during sleep state with robust and interpretable machine learning models. **It was first reported by Urrestarazu et al. [13] (2009) that beta oscillations in the STN of PD patients decreased in non-REM sleep and recovered in REM sleep.** The modulation of beta oscillation during movements in REM sleep was shown to be different with that during wakefulness [35], [42]. It was also suggested by Thompson et al. [14] (2017) that all frequency bands were significantly different between sleep stages. **In our study, group analysis in the full frequency band showed that three low frequency bands (delta, theta, and alpha band) have a consistent trend of power increase in non-REM sleep and power decrease to a similar degree with wakefulness in REM sleep. The remaining high frequency band (beta and gamma band) has an opposite trend of power decrease in nonREM sleep and increase in REM sleep.** These results are generally consistent with previous studies conducted during DBS surgery, but elucidate sleep patterns with full-band analysis at the group level and without acute surgical interferences [18], [19]. Furthermore, from the feature importance analysis of the classifiers in Fig. 9, we found that the largest modulation effects of wakefulness and sleep lie in the beta, alpha, and gamma bands, which are critical for the development of closed-loop DBS."

## Conclusion and future work
- "From the perspective of engineering, **embeddable algorithms with less computing cost and memory requirements should be considered.** From the perspective of improving the classification performance, more precise correlation between the STN-LFP and awareness state needs to be clarified, especially for the sleep state transition periods. **Other methods such as deep neural networks, wavelet transform, random forest, and multiple ensemble methods may increase the performance.**"

## Relevant references
- [2]. Comella CL, “Sleep disorders in Parkinson’s disease: An overview,” Movement Disorders, vol. 22, no. S17, pp. S367–S373, Dec. 2007. [PubMed: 18175398] 
- [3]. Tekriwal A et al., “REM sleep behaviour disorder: Prodromal and mechanistic insights for Parkinson’s disease,” J. Neurol. Neurosurg. Psychiatry, vol. 88, no. 5, pp. 445–51, Dec. 2016.[PubMed: 27965397] 
- [4]. Baumann-Vogel H et al., “The impact of subthalamic deep brain stimulation on sleep-wake behavior: A prospective electrophysiological study in 50 Parkinson patients,” Sleep, vol. 40, no. 5, pp. 1–9, Mar. 2017.
- [5]. Chahine L, Ahmed A, and Sun Z, “Effects of STN DBS for Parkinson’s disease on restless legs syndrome and other sleep-related measures,” Parkinsonism Rel. Disorders, vol. 17, no. 3, pp. 208–211, Mar. 2011.
- [6]. Umemura A, Oka Y, Yamamoto K, Okita K, Matsukawa N, and Yamada K, “Complications of subthalamic nucleus stimulation in Parkinson’s disease,” Neurol. Medico-Chirurgica, vol. 51, no. 11, pp. 749–755, Nov-Jul 2011.
- [7]. Kim YE et al., “Rapid eye movement sleep behavior disorder after bilateral subthalamic stimulation in Parkinson’s disease,” J. Clin. Neurosci, vol. 22, no. 2, pp. 315–319, Feb. 2014. [PubMed: 25439757]
- [10]. Little S and Brown P, “What brain signals are suitable for feedback control of deep brain stimulation in Parkinson’s disease?” Ann. York Acad. Sci, vol. 1265, no. 1, pp. 9–24, Jul. 2012.
- [11]. Kühn AA et al., “High-frequency stimulation of the subthalamic nucleus suppresses oscillatory ß activity in patients with Parkinson’s disease in parallel with improvement in motor performance,” J. Neurosci, vol. 28, no. 24, pp. 6165–6173, Jun. 2008. [PubMed: 18550758]
- [12]. Brittain J-S and Brown P, “Oscillations and the basal ganglia: Motor control and beyond,” Neuroimage, vol. 85, pp. 637–647, Jan. 2014. [PubMed: 23711535]
- [13]. Urrestarazu E et al., “Beta activity in the subthalamic nucleus during sleep in patients with Parkinson’s disease,” Movement Disorders, vol. 24, no. 2, pp. 254–260, Oct. 2008.
- [14]. Thompson JA et al., “Sleep patterns in Parkinson’s disease: Direct recordings from the subthalamic nucleus,” J. Neurol. Neurosurg. Psychiatry, vol. 89, no. 1, pp. 95–104, Jan. 2017. [PubMed: 28866626]
- [17]. Qian X, Chen Y, Ma B, Hao H, and Li L, “Chronically monitoring the deep brain rhythms: From stimulation to recording,” Sci. Bull, vol. 61, no. 19, pp. 1522–1524, Oct. 2016.
- [18]. Mann JM et al., “Brain penetration effects of microelectrodes and DBS leads in STN or GPi,” J. Neurol., Neurosurgery Psychiatry, vol. 80, no. 7, pp. 794–798, Feb. 2009.
- [19]. Deogaonkar M, Nazzaro JM, Machado A, and Rezai A, “Transient, symptomatic, post-operative, non-infectious hypodensity around the deep brain stimulation (DBS) electrode,” J. Clin. Neurosci, vol. 18, no. 7, pp. 910–915, Jul. 2011. [PubMed: 21571534]
- [27]. Suykens JAK and Vandewalle J, “Least squares support vector machine classifiers,” Neural Process. Lett, vol. 9, no. 3, pp. 293–300, Jun. 1999. 
- [28]. Chang C-C and Lin C-J, “LIBSVM: A library for support vector machines,” ACM Trans. Intell. Syst. Technol, vol. 2, no. 3, pp. 27:1–27:27, 2011.
- [29]. Landgrebe D, “A survey of decision tree classifier methodology,” IEEE Trans. Syst., Man Cybern, vol. 21, no. 3, pp. 660–674, 5 1991.
- [31]. Loh W-Y, “Classification and regression trees,” Wiley Interdiscipl. Rev., Data Mining Knowl. Discovery, vol. 1, no. 1, pp. 14–23, 12011.
- [32]. Imtiaz SA and Rodriguez-Villegas E, “Recommendations for performance assessment of automatic sleep staging algorithms,” in Proc. 36th Annu. Int. Conf. IEEE Eng. Med. Biol. Soc, Aug. 2014, pp. 5044–5047.
- [42]. Hackius M, Werth E, Sürücü O, Baumann CR, and Imbach LL, “Electrophysiological evidence for alternative motor networks in REM sleep behavior disorder,” J. Neurosci, vol. 36, no. 46, pp. 11795–11800, Nov. 2016. [PubMed: 27852786]
